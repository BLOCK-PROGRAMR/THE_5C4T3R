<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gasless Token Approvals? Let’s Talk ERC-2612 `permit()`</title>
    <link rel="stylesheet" href="/assets/css/style.css">
    <style>
        /* --- FONTS --- */
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code&family=IBM+Plex+Mono:wght@400;600&display=swap');

        /* --- GENERAL BODY STYLES --- */
        body {
            background-color: #121212;
            color: #E0E0E0;
            font-family: 'IBM Plex Mono', monospace;
            margin: 0;
            padding: 0;
            font-size: 1.1rem;
            line-height: 1.7;
        }

        /* --- KEY CHANGE: HEADER LAYOUT --- */
        header {
            padding: 1rem;
            border-bottom: 1px solid #2a2a2a;
        }

        .header-container {
            max-width: 960px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 2rem;
            /* Space between name and nav links */
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
            /* Space between social icons */
        }

        header h1 {
            margin: 0;
            font-family: 'Fira Code', monospace;
            font-size: 1.5rem;
            /* Adjusted size for new layout */
            font-weight: 600;
            color: #FFFFFF;
        }

        nav {
            display: flex;
            gap: 1.2rem;
            flex-wrap: wrap;
        }

        nav a {
            color: #CCCCCC;
            text-decoration: none;
            font-size: 1rem;
            padding: 0.25rem 0;
            transition: color 0.2s ease-in-out;
            font-family: 'Fira Code', monospace;
        }

        nav a:hover {
            color: #ff4d4d;
            text-decoration: underline;
        }

        /* --- KEY ADDITION: SOCIAL ICON STYLES --- */
        .social-icon svg {
            width: 22px;
            height: 22px;
            fill: #CCCCCC;
            transition: fill 0.2s ease-in-out;
        }

        .social-icon:hover svg {
            fill: #ff4d4d;
        }

        /* --- MAIN CONTENT --- */
        main {
            /* --- KEY CHANGE: Page extended left and right --- */
            max-width: 960px;
            margin: 3rem auto;
            padding: 0 1rem;
        }

        a {
            color: #FFFFFF;
            text-decoration: underline;
            font-weight: 600;
            transition: color 0.2s ease-in-out;
        }

        a:hover {
            color: #ff4d4d;
        }

        h1,
        h2,
        h3,
        h4 {
            font-family: 'Fira Code', monospace;
            color: #FFFFFF;
            font-weight: 600;
            margin-bottom: 1rem;
            margin-top: 2.5rem;
        }

        p {
            margin-bottom: 1.2rem;
        }

        /* --- STYLES FOR CODE BLOCKS AND COPY BUTTON --- */
        .code-container {
            position: relative;
        }

        pre {
            background-color: #1E1E1E;
            border: 1px solid #333333;
            padding: 1.5rem;
            padding-top: 3rem;
            overflow-x: auto;
            font-family: 'Fira Code', monospace;
            font-size: 1rem;
            border-radius: 5px;
            margin: 1.5rem 0;
        }

        code {
            font-family: 'Fira Code', monospace;
        }

        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #333;
            color: #E0E0E0;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 0.3rem 0.6rem;
            font-family: 'IBM Plex Mono', monospace;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
        }

        .copy-button:hover {
            background-color: #444;
            color: #FFFFFF;
        }
    </style>
</head>

<body>
    <header>
        <div class="header-container">
            <div class="header-left">
                <h1><a href="/" style="text-decoration:none; color: inherit;">Nithin Kumar</a></h1>

                <nav>
                    <!-- <a href="/">Home</a> -->
                    <a href="/writeups">Writeups</a>
                    <a href="/analysis">Analysis</a>
                    <a href="/audits">Audits</a>
                    <a href="/projects">Projects</a>
                    <a href="/contact">Contact</a>
                    <a href="/tags">Tags</a>
                </nav>

            </div>
            <div class="header-right">
                <a href="https://github.com/BLOCK-PROGRAMR" class="social-icon" title="GitHub">
                    <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" />
                    </svg>
                </a>
                <a href="https://www.linkedin.com/in/5C4T3R" class="social-icon" title="LinkedIn">
                    <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.15 0-2.08-.926-2.08-2.065 0-1.138.93-2.066 2.08-2.066 1.153 0 2.08.928 2.08 2.066 0 1.139-.928 2.065-2.08 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.225 0z" />
                    </svg>
                </a>
                <a href="https://x.com/0x_Scater" class="social-icon" title="X (Twitter)">
                    <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z" />
                    </svg>
                </a>
                <a href="mailto:0xscater@gmail.com" class="social-icon" title="Email">
                    <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6zm-2 0l-8 5-8-5h16zm0 12H4V8l8 5 8-5v10z" />
                    </svg>
                </a>
            </div>
        </div>
    </header>

    <main>
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Gasless Token Approvals? Let’s Talk ERC-2612 `permit()`</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-04-30T00:00:00+00:00" itemprop="datePublished">Apr 30, 2025
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="gasless-token-approvals-lets-talk-erc-2612-permit">Gasless Token Approvals? Let’s Talk ERC-2612 <code class="language-plaintext highlighter-rouge">permit()</code></h1>

<blockquote>
  <p>“Web3 and blockchain run on protocols — every improvement is a protocol upgrade, not just a feature update.”<br />
— 0x_scater</p>
</blockquote>

<hr />

<h3 id="introduction">Introduction</h3>

<p>When building in Web3, understanding protocol-level innovations is critical. One such innovation is <a href="https://eips.ethereum.org/EIPS/eip-2612">ERC-2612</a>, which upgrades the standard ERC-20 token approval mechanism to support <strong>gasless approvals</strong>.</p>

<p>This blog explores:</p>

<ul>
  <li>Why ERC-2612 exists</li>
  <li>How it improves the user experience</li>
  <li>How it works under the hood using EIP-712 signatures</li>
  <li>Why it’s important for onboarding and adoption</li>
</ul>

<p>Let’s compare the traditional ERC-20 flow with ERC-2612.</p>

<hr />

<h2 id="traditional-erc-20-flow">Traditional ERC-20 Flow</h2>

<p>ERC-20 token transfers with smart contracts (like staking, DEXs, etc.) require two transactions:</p>

<h3 id="old-flow-erc-20">Old Flow (ERC-20):</h3>

<ol>
  <li><code class="language-plaintext highlighter-rouge">approve(spender, amount)</code>
    <ul>
      <li>Sent by token owner <code class="language-plaintext highlighter-rouge">X</code></li>
      <li>Requires ETH to pay for gas</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">transferFrom(owner, recipient, amount)</code>
    <ul>
      <li>Called by the contract <code class="language-plaintext highlighter-rouge">Y</code></li>
    </ul>
  </li>
</ol>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="s">participant X as User</span>
    <span class="s">participant T as Token Contract</span>
    <span class="s">participant Y as Protocol Contract</span>

    <span class="s">X-&gt;&gt;T</span><span class="err">:</span> <span class="s">approve(Y, amount)</span>
    <span class="s">Note right of X</span><span class="err">:</span> <span class="s">Pays gas</span>
    <span class="s">Y-&gt;&gt;T</span><span class="err">:</span> <span class="s">transferFrom(X, Y, amount)</span>
</code></pre></div></div>

<h3 id="drawbacks">Drawbacks:</h3>
<p>Requires two on-chain transactions</p>

<p>1.Users must own ETH to approve</p>

<p>2.Onboarding becomes harder (especially for new users who don’t have ETH yet)</p>

<h3 id="introduce-erc-2612-the-permit">Introduce ERC-2612: The permit()</h3>

<p>ERC-2612 introduces a new function:</p>
<pre><code class="language-solidity">function permit(
    address owner,
    address spender,
    uint256 value,
    uint256 deadline,
    uint8 v, bytes32 r, bytes32 s
) external;

</code></pre>
<p>This allows a user (owner) to sign a gasless approval off-chain and any relayer (spender or someone else) to submit it on-chain.</p>

<p>#### Flow (ERC-2612):</p>

<p>1.X signs an EIP-712 message off-chain</p>

<p>2.Y (or any relayer) calls permit() + transferFrom()</p>

<p>Single transaction and No ETH required from X</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="s">participant X as User</span>
    <span class="s">participant Y as Relayer</span>
    <span class="s">participant T as Token Contract</span>
    <span class="s">X-&gt;&gt;X</span><span class="err">:</span> <span class="s">Sign permit message (EIP-712)</span>
    <span class="s">Y-&gt;&gt;T</span><span class="err">:</span> <span class="s">permit(X, Y, amount, ...)</span>
    <span class="s">Y-&gt;&gt;T</span><span class="err">:</span> <span class="s">transferFrom(X, Y, amount)</span>
</code></pre></div></div>
<h3 id="query-raiseshow--does-it-work">Query raises:How  does it work?</h3>

<p>The permit() function uses the EIP-712 standard to verify typed data signatures.</p>

<p><strong><em>EIP-712 Typed Data Signature</em></strong>:</p>

<p>EIP-712 allows for secure and human-readable signing by hashing a structured payload. This avoids generic sign() messages, enabling wallet providers (like MetaMask) to show readable content.</p>

<p>Example of payload:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"types"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"EIP712Domain"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w"> </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"version"</span><span class="p">,</span><span class="w"> </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"chainId"</span><span class="p">,</span><span class="w"> </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uint256"</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"verifyingContract"</span><span class="p">,</span><span class="w"> </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address"</span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"Permit"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"owner"</span><span class="p">,</span><span class="w"> </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address"</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spender"</span><span class="p">,</span><span class="w"> </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address"</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value"</span><span class="p">,</span><span class="w"> </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uint256"</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nonce"</span><span class="p">,</span><span class="w"> </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uint256"</span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deadline"</span><span class="p">,</span><span class="w"> </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uint256"</span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyToken"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"chainId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"verifyingContract"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xYourTokenAddress"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xX..."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"spender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0xY..."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1000000000000000000"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"nonce"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"deadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">1742680400</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>### Real Permit() code:</p>
<pre><code class="language-solidity"> / Token contract includes this:
function permit(
    address owner,
    address spender,
    uint256 value,
    uint256 deadline,
    uint8 v, bytes32 r, bytes32 s
) external {
    require(block.timestamp &lt;= deadline, "Permit: expired deadline");

    bytes32 digest = keccak256(
        abi.encodePacked(
            "\x19\x01",
            DOMAIN_SEPARATOR,
            keccak256(abi.encode(
                PERMIT_TYPEHASH,
                owner,
                spender,
                value,
                nonces[owner]++,
                deadline
            ))
        )
    );

    address recoveredAddress = ecrecover(digest, v, r, s);
    require(recoveredAddress == owner, "Invalid signature");

    _approve(owner, spender, value);
}
</code></pre>
<h3 id="why-need-erc-2612">Why need ERC-2612?</h3>

<ol>
  <li>
    <p>Gasless UX: New users can approve tokens without ETH — just sign a message.</p>
  </li>
  <li>
    <p>One-Tx Flow: Only one transaction to complete an approval and usage, improving developer and user experience.</p>
  </li>
  <li>
    <p>Relayer-Friendly :Projects can sponsor gas fees for onboarding using relayers.</p>
  </li>
  <li>
    <p>Protocol-Level Upgrade: It’s not just a frontend trick — it changes the way ERC-20 tokens behave at the contract level.</p>
  </li>
</ol>

<h3 id="real-world-applications">Real-World Applications</h3>

<ol>
  <li>
    <p>DEXs (like Uniswap) use permit() to enable one-click swaps</p>
  </li>
  <li>
    <p>DAOs allow gasless voting setups</p>
  </li>
  <li>
    <p>DeFi protocols onboard users without forcing them to buy ETH</p>
  </li>
</ol>

<h4 id="building-with-protocols-in-mind">Building With Protocols In Mind</h4>

<p>ERC-2612 is a great example of how protocol-level upgrades make real impact.</p>

<p>If you’re building in Web3, always ask:</p>

<p>Can I make this process more user-friendly at the protocol level?</p>

<p><strong><em>Final Thoughts — SCATERLABs</em></strong></p>

<p>Gasless approvals aren’t a feature; they’re a shift in the ERC-20 interaction model.</p>

<p>They show what’s possible when we treat protocols as products.</p>

<p>Let’s keep building with protocols in mind.</p>

<p>— 0x_scater, Founder @ SCATERLABs</p>

<h4 id="resources-i-used">Resources i used:</h4>

<ol>
  <li>
    <p>EIP-2612: https://eips.ethereum.org/EIPS/eip-2612</p>
  </li>
  <li>
    <p>EIP-712: https://eips.ethereum.org/EIPS/eip-712</p>
  </li>
  <li>
    <p>I use chatgpt for understanding the protocols</p>
  </li>
</ol>


  </div><a class="u-url" href="/analysis/2025/04/30/ERC2612.html" hidden></a>
</article>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const preBlocks = document.querySelectorAll('pre');
            preBlocks.forEach(pre => {
                if (pre.parentNode.classList.contains('code-container')) return; // Avoid re-wrapping
                const container = document.createElement('div');
                container.className = 'code-container';
                const copyButton = document.createElement('button');
                copyButton.className = 'copy-button';
                copyButton.textContent = 'Copy';
                pre.parentNode.insertBefore(container, pre);
                container.appendChild(pre);
                container.appendChild(copyButton);
                copyButton.addEventListener('click', () => {
                    const code = pre.querySelector('code').innerText;
                    navigator.clipboard.writeText(code).then(() => {
                        copyButton.textContent = 'Copied!';
                        setTimeout(() => {
                            copyButton.textContent = 'Copy';
                        }, 2000);
                    }).catch(err => {
                        console.error('Failed to copy: ', err);
                    });
                });
            });
        });
    </script>
</body>

</html>